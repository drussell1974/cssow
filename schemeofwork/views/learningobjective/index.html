{{extend '__layout.html'}}
{{block header}}
<div class="row">
  <div class="col-lg-8 col-md-10 mx-auto">
    <div class="site-heading">
      <h1>{{=content["main_heading"]}}</h1>
      <span class="subheading">{{=content["sub_heading"]}}</span>
    </div>
  </div>
</div>
{{end}}
<nav class="navbar navbar-expand-lg navbar-light" id="itemNav">
      <div class="container">

          <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                  <a class="nav-link" href="{{=URL('default','index')}}">Home</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{{=URL('schemesofwork', 'index')}}">Schemes of work</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="{{=URL('learningepisode', 'index', vars=dict(scheme_of_work_id=scheme_of_work_id))}}">Learning episodes</a>
                </li>
                {{if auth.user:}}
               <li class="nav-item">
                    <a class="nav-link" href="{{=URL('learningobjective', 'edit', vars=dict(learning_episode_id=learning_episode_id, scheme_of_work_id=scheme_of_work_id))}}">|{{=T('new')}}</a>
               </li>
              {{pass}}
            </ul>
    </div>
</nav>
<!-- Main Content -->
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
            <!-- Filters Start -->
                <form name="edit-learningepisode" id="learningepisodeEdit" method="get">
                    <div class="control-group">
                      <div class="form-group floating-label-form-group controls">
                        <label>Scheme of work</label>
                        <select class="form-control" id="learning_episode_id" name="learning_episode_id" required data-validation-required-message="Please select a scheme of work." onchange="this.form.submit()">
                            <option value="">- Select a learning episode -</option>
                            {{ for opt in learningepisiode_options:}}
                                <option value="{{=opt.id}}" {{if opt.id == learning_episode_id :}} selected {{pass}}>{{=opt.order_of_delivery_id}}</option>
                            {{ pass }}
                        </select>
                        <p class="help-block text-danger"></p>
                     </div>
                  </div>
                    <input type="hidden" name="scheme_of_work_id" value="{{=scheme_of_work_id}}">
              </form>
            <!-- Filters END -->
          <!-- Show learning objectives for this learning episode -->
          {{ for row in model: }}
          <div class="post-preview">
            <a href="{{=URL('learningepisodes', 'view', vars=dict(id=row.id))}}">
              <h2 class="post-title">
                {{=row.description}}
              </h2>
            </a>
            <p class="post-meta">Created by
              <a href="#">{{=row.created_by_name}}</a>
              {{if row.created: }}
                on {{=str(row.date_created_ui())}}
              {{ pass }}
              {{if auth.user:}}
                - <a href="{{=URL('learningobjective', 'delete_item', vars=dict(id=row.id, learning_episode_id=row.learning_episode_id, scheme_of_work_id=scheme_of_work_id))}}">remove</a> - <a href="{{=URL('learningobjective', 'edit', vars=dict(id=row.id,learning_episode_id=row.learning_episode_id,scheme_of_work_id=scheme_of_work_id))}}">edit</a>
              {{pass}}</p>
          </div>
          <hr>
            {{ pass }}
          <!-- Show learning objectives for this learning episode  END -->
          <!-- Pager -->
          <div class="clearfix">
            <a class="btn btn-primary float-right" href="#">Older Posts &rarr;</a>
          </div>
        </div>

      </div>

    {{if auth.user and len(unassociated_learning_objectives) > 0:}}
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
            <!-- Related learning objectives -->
            <h2>Releated learning objectives</h2>
            <p>Click to add to {{=content["sub_heading"]}}</p>
            {{ current_topic_id = 0}}
          {{ for row in unassociated_learning_objectives: }} <!-- unassociated_learning_objectives ordered by topic -->
            {{ if current_topic_id != int(row.topic_id): }}
            {{ current_topic_id = row.topic_id }}
            <h3>{{=row.topic_name}}</h3>
            {{ pass }}
          <div class="post-preview">
            <p class="post-meta">
                <a href="{{=URL('learningobjective', 'add_existing_objective', vars=dict(id=row.id,learning_episode_id=row.learning_episode_id,scheme_of_work_id=scheme_of_work_id))}}">{{=row.description}}</a>
                 <br><i class="small">
                    by <a href="#">{{=row.created_by_name}}</a>
                    {{if row.created: }}
                        on {{=str(row.date_created_ui())}}
                    {{ pass }}
                </i>

            </p>
          </div>
            {{ pass }}
          <!-- Related learning objectives END -->
            <div class="clearfix">
            <a class="btn btn-primary float-right" href="#">Older Posts &rarr;</a>
          </div>
        </div>
    {{pass}}
        </div>
      </div>
    </div>

    <hr>

    <!-- Main Content END -->
{{block page_js}}
{{end page_js}}
