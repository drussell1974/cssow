{% extends 'default/__layout.twocolumn.html' %}
{% block breadcrumb %}
<nav class="navbar navbar-expand-lg navbar-light" id="itemNav">
  <div class="container">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" id="lnk-bc-schemes_of_work" href="{% url 'schemesofwork.index' %}">
            {{_("Schemes of Work")}}
          </a>
        </li>
      </ul>
  </div>
</nav>
{% endblock %}


{% block sidecontent %}
<nav class="navbar navbar-expand-lg navbar-light" id="sidebarNav">
  <button class="navbar-toggler btn" type="button" data-toggle="collapse" data-target="#sidebarResponsive" aria-controls="sidebarResponsive" aria-expanded="true" aria-label="Toggle navigation">
      {{_("scheme of work")}} <i class="fas fa-bars"></i>
  </button>
  <div class="collapse navbar-collapse" id="sidebarResponsive">
      <ul class="navbar-nav flex-column fillspace">
      {% for opt in content.data.schemeofwork_options %}
          <li class="nav-item {% if opt.id == scheme_of_work_id %}mark{% endif %}">
              <a class="nav-link" href="{% url 'lesson.index' opt.id %}">
                {{ opt.name}} <div class="small">{{ opt.key_stage_name}}</div>
              </a>
          </li>
      {% endfor %}
      </ul>
      <hr>
  </div>
</nav>
{% endblock %}


{% block maincontent %}
<!-- Pager Header  -->
<div class="clearfix">
  <ul class="pagination" style="display:none">
      =XML(pager_html)
  </ul>
</div>
{% if request.user.is_authenticated %}
  <span class="float-right">
    <a class="btn btn-warning" id="btn-new" href="{% url 'lesson.new' content.data.scheme_of_work_id %}">{{_('add')}}</a>
  </span>
{% endif %}
<h2 class="group-heading">{{_("Lessons")}}</h2>
<hr />
  <!-- Pager Header END -->
<!-- Scheme of works -->

{% if content.data.lessons|length == 0 %}
  <div class="alert alert-info" role="alert">
      <span class="small">{{_('There are no lessons for this scheme of work.')}}</span>
  {% if request.user.is_authenticated %}
      <br><a href="{% url 'lesson.new' content.data.scheme_of_work_id %}">{{_('Click here to get started.')}}</a>
  {% endif %}
  </div>
{% endif %}

{% for row in content.data.lessons %}
  
<div class="post-preview {{ row.published_state }}">
  <a name="{{ row.id}}"></a>
  
  <a class="edit" href="{% url 'lesson.edit' row.scheme_of_work_id row.id %}?return={{request.url}}">
    <h3 class="post-title">
      Lesson {{ row.order_of_delivery_id }} - {{ row.title }}
    </h3>
    {% if row.summary != "" %}
      <h4 class="post-subtitle">{{ row.summary }}</h4>
    {% endif %}
  </a>
  <div class="badge-group">
    {% for key_word in row.key_words %}
      <i class="badge badge-secondary" data-toggle="popover" data-placement="bottom" title="{{ key_word.term }}" data-content="{{ key_word.definition }}" >{{ key_word.term }}</i>&nbsp;
    {% endfor %}
  </div>
  <div class="links stackable-group-sm">
    <a href="{% url 'learningobjective.index' row.scheme_of_work_id row.id %}" class="btn btn-outline-dark stackable">
      {{_("Learning objectives")}} <span class="badge badge-light">{{row.number_of_learning_objective}}</span>
    </a>
    <a href="{% url 'resource.index' row.scheme_of_work_id row.id %}"  class="btn btn-outline-dark stackable">
      {{_("Resources")}} <span class="badge badge-light" >{{row.number_of_resource}}</span>
    </a>
  </div>
  <p class="post-meta">{{_("Created by")}}
    <a href="#">{{ row.created_by_name }}</a>
    {% if row.created %}
      on {{ row.created }}
    {% endif %}
    {% if request.user.is_authenticated %}
        {% if row.published == False %} 
          <a href="{% url 'lesson.publish_item' content.data.scheme_of_work_id row.id %}?return={{request.url}}" class="small badge badge-danger">{{_("not published")}}</a>
        {% endif %}
        <a href="{% url 'lesson.copy' row.scheme_of_work_id row.id %}">{{_("copy")}}</a> 
    {% endif %} 
    </p>
</div>
<hr>

{% endfor %}
<!-- Pager Footer -->
<div class="clearfix">
  <ul class="pagination" style="display:none">
      =XML(pager_html)
  </ul>
</div>
  <!-- Pager Footer END -->

<!-- Scheme of works END -->
<hr />

{% if request.user.is_authenticated %}
<a class="navbar-brand btn btn-danger float-right" id="btn-delete-unpublished" href="{% url 'lesson.delete_unpublished' content.data.scheme_of_work_id %}">{{_('Clean')}}</a>
{% endif %}

{% endblock %}
